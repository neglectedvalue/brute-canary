#pragma once

#include <gsl/gsl>

// This graphics dramatically slows down my terminal, man. So it is disabled
// for non-release builds.
#if defined(NDEBUG)
# define SMILE " üåù "
#else
# define SMILE " * "
#endif

#if defined(NDEBUG)
# define SMITE " üåö "
#else
# define SMITE " o "
#endif

#if defined(PROFILE)
# undef PROFILE
# define PROFILE(...) __VA_ARGS__
#else
# define PROFILE(...)
#endif

static gsl::cstring_span<> const Whitespace = " ";

static gsl::cstring_span<> const Words[] = {
  "like", "just", "love", "know", "never", "want", "time", "out",
  "there", "make", "look", "eye", "down", "only", "think",
  "heart", "back", "then", "into", "about", "more", "away",
  "still", "them", "take", "thing", "even", "through", "long",
  "always", "world", "too", "friend", "tell", "try", "hand",
  "thought", "over", "here", "other", "need", "smile", "again",
  "much", "cry", "been", "night", "ever", "little", "said",
  "end", "some", "those", "around", "mind", "people", "girl",
  "leave", "dream", "left", "turn", "myself", "give", "nothing",
  "really", "off", "before", "something", "find", "walk", "wish",
  "good", "once", "place", "ask", "stop", "keep", "watch",
  "seem", "everything", "wait", "got", "yet", "made", "remember",
  "start", "alone", "run", "hope", "maybe", "believe", "body",
  "hate", "after", "close", "talk", "stand", "own", "each",
  "hurt", "help", "home", "god", "soul", "new", "many", "two",
  "inside", "should", "true", "first", "fear", "mean", "better",
  "play", "another", "gone", "change", "use", "wonder",
  "someone", "hair", "cold", "open", "best", "any", "behind",
  "happen", "water", "dark", "laugh", "stay", "forever", "name",
  "work", "show", "sky", "break", "came", "deep", "door", "put",
  "black", "together", "upon", "happy", "such", "great", "white",
  "matter", "fill", "past", "please", "burn", "cause", "enough",
  "touch", "moment", "soon", "voice", "scream", "anything",
  "stare", "sound", "red", "everyone", "hide", "kiss", "truth",
  "death", "beautiful", "mine", "blood", "broken", "very",
  "pass", "next", "forget", "tree", "wrong", "air", "mother",
  "understand", "lip", "hit", "wall", "memory", "sleep", "free",
  "high", "realize", "school", "might", "skin", "sweet",
  "perfect", "blue", "kill", "breath", "dance", "against", "fly",
  "between", "grow", "strong", "under", "listen", "bring",
  "sometimes", "speak", "pull", "person", "become", "family",
  "begin", "ground", "real", "small", "father", "sure", "feet",
  "rest", "young", "finally", "land", "across", "today",
  "different", "guy", "line", "fire", "reason", "reach",
  "second", "slowly", "write", "eat", "smell", "mouth", "step",
  "learn", "three", "floor", "promise", "breathe", "darkness",
  "push", "earth", "guess", "save", "song", "above", "along",
  "both", "color", "house", "almost", "sorry", "anymore",
  "brother", "okay", "dear", "game", "fade", "already", "apart",
  "warm", "beauty", "heard", "notice", "question", "shine",
  "began", "piece", "whole", "shadow", "secret", "street",
  "within", "finger", "point", "morning", "whisper", "child",
  "moon", "green", "story", "glass", "kid", "silence", "since",
  "soft", "yourself", "empty", "shall", "angel", "answer",
  "baby", "bright", "dad", "path", "worry", "hour", "drop",
  "follow", "power", "war", "half", "flow", "heaven", "act",
  "chance", "fact", "least", "tired", "children", "near",
  "quite", "afraid", "rise", "sea", "taste", "window", "cover",
  "nice", "trust", "lot", "sad", "cool", "force", "peace",
  "return", "blind", "easy", "ready", "roll", "rose", "drive",
  "held", "music", "beneath", "hang", "mom", "paint", "emotion",
  "quiet", "clear", "cloud", "few", "pretty", "bird", "outside",
  "paper", "picture", "front", "rock", "simple", "anyone",
  "meant", "reality", "road", "sense", "waste", "bit", "leaf",
  "thank", "happiness", "meet", "men", "smoke", "truly",
  "decide", "self", "age", "book", "form", "alive", "carry",
  "escape", "damn", "instead", "able", "ice", "minute", "throw",
  "catch", "leg", "ring", "course", "goodbye", "lead", "poem",
  "sick", "corner", "desire", "known", "problem", "remind",
  "shoulder", "suppose", "toward", "wave", "drink", "jump",
  "woman", "pretend", "sister", "week", "human", "joy", "crack",
  "grey", "pray", "surprise", "dry", "knee", "less", "search",
  "bleed", "caught", "clean", "embrace", "future", "king", "son",
  "sorrow", "chest", "hug", "remain", "sat", "worth", "blow",
  "daddy", "final", "parent", "tight", "also", "create",
  "lonely", "safe", "cross", "dress", "evil", "silent", "bone",
  "fate", "perhaps", "anger", "class", "scar", "snow", "tiny",
  "tonight", "continue", "control", "dog", "edge", "mirror",
  "month", "suddenly", "comfort", "given", "loud", "quickly",
  "gaze", "plan", "rush", "stone", "town", "battle", "ignore",
  "spirit", "stood", "stupid", "yours", "brown", "build", "dust",
  "hey", "kept", "pay", "phone", "twist", "although", "ball",
  "beyond", "hidden", "nose", "taken", "fail", "float", "pure",
  "somehow", "wash", "wrap", "angry", "cheek", "creature",
  "forgotten", "heat", "rip", "single", "space", "special",
  "weak", "whatever", "yell", "anyway", "blame", "job", "choose",
  "country", "curse", "drift", "echo", "figure", "grew",
  "laughter", "neck", "suffer", "worse", "yeah", "disappear",
  "foot", "forward", "knife", "mess", "somewhere", "stomach",
  "storm", "beg", "idea", "lift", "offer", "breeze", "field",
  "five", "often", "simply", "stuck", "win", "allow", "confuse",
  "enjoy", "except", "flower", "seek", "strength", "calm",
  "grin", "gun", "heavy", "hill", "large", "ocean", "shoe",
  "sigh", "straight", "summer", "tongue", "accept", "crazy",
  "everyday", "exist", "grass", "mistake", "sent", "shut",
  "surround", "table", "ache", "brain", "destroy", "heal",
  "nature", "shout", "sign", "stain", "choice", "doubt",
  "glance", "glow", "mountain", "queen", "stranger", "throat",
  "tomorrow", "city", "either", "fish", "flame", "rather",
  "shape", "spin", "spread", "ash", "distance", "finish",
  "image", "imagine", "important", "nobody", "shatter", "warmth",
  "became", "feed", "flesh", "funny", "lust", "shirt", "trouble",
  "yellow", "attention", "bare", "bite", "money", "protect",
  "amaze", "appear", "born", "choke", "completely", "daughter",
  "fresh", "friendship", "gentle", "probably", "six", "deserve",
  "expect", "grab", "middle", "nightmare", "river", "thousand",
  "weight", "worst", "wound", "barely", "bottle", "cream",
  "regret", "relationship", "stick", "test", "crush", "endless",
  "fault", "itself", "rule", "spill", "art", "circle", "join",
  "kick", "mask", "master", "passion", "quick", "raise",
  "smooth", "unless", "wander", "actually", "broke", "chair",
  "deal", "favorite", "gift", "note", "number", "sweat", "box",
  "chill", "clothes", "lady", "mark", "park", "poor", "sadness",
  "tie", "animal", "belong", "brush", "consume", "dawn",
  "forest", "innocent", "pen", "pride", "stream", "thick",
  "clay", "complete", "count", "draw", "faith", "press",
  "silver", "struggle", "surface", "taught", "teach", "wet",
  "bless", "chase", "climb", "enter", "letter", "melt", "metal",
  "movie", "stretch", "swing", "vision", "wife", "beside",
  "crash", "forgot", "guide", "haunt", "joke", "knock", "plant",
  "pour", "prove", "reveal", "steal", "stuff", "trip", "wood",
  "wrist", "bother", "bottom", "crawl", "crowd", "fix",
  "forgive", "frown", "grace", "loose", "lucky", "party",
  "release", "surely", "survive", "teacher", "gently", "grip",
  "speed", "suicide", "travel", "treat", "vein", "written",
  "cage", "chain", "conversation", "date", "enemy", "however",
  "interest", "million", "page", "pink", "proud", "sway",
  "themselves", "winter", "church", "cruel", "cup", "demon",
  "experience", "freedom", "pair", "pop", "purpose", "respect",
  "shoot", "softly", "state", "strange", "bar", "birth", "curl",
  "dirt", "excuse", "lord", "lovely", "monster", "order", "pack",
  "pants", "pool", "scene", "seven", "shame", "slide", "ugly",
  "among", "blade", "blonde", "closet", "creek", "deny", "drug",
  "eternity", "gain", "grade", "handle", "key", "linger", "pale",
  "prepare", "swallow", "swim", "tremble", "wheel", "won",
  "cast", "cigarette", "claim", "college", "direction", "dirty",
  "gather", "ghost", "hundred", "loss", "lung", "orange",
  "present", "swear", "swirl", "twice", "wild", "bitter",
  "blanket", "doctor", "everywhere", "flash", "grown",
  "knowledge", "numb", "pressure", "radio", "repeat", "ruin",
  "spend", "unknown", "buy", "clock", "devil", "early", "false",
  "fantasy", "pound", "precious", "refuse", "sheet", "teeth",
  "welcome", "add", "ahead", "block", "bury", "caress",
  "content", "depth", "despite", "distant", "marry", "purple",
  "threw", "whenever", "bomb", "dull", "easily", "grasp",
  "hospital", "innocence", "normal", "receive", "reply", "rhyme",
  "shade", "someday", "sword", "toe", "visit", "asleep",
  "bought", "center", "consider", "flat", "hero", "history",
  "ink", "insane", "muscle", "mystery", "pocket", "reflection",
  "shove", "silently", "smart", "soldier", "spot", "stress",
  "train", "type", "view", "whether", "bus", "energy", "explain",
  "holy", "hunger", "inch", "magic", "mix", "noise", "nowhere",
  "prayer", "presence", "shock", "snap", "spider", "study",
  "thunder", "trail", "admit", "agree", "bag", "bang", "bound",
  "butterfly", "cute", "exactly", "explode", "familiar", "fold",
  "further", "pierce", "reflect", "scent", "selfish", "sharp",
  "sink", "spring", "stumble", "universe", "weep", "women",
  "wonderful", "action", "ancient", "attempt", "avoid",
  "birthday", "branch", "chocolate", "core", "depress", "drunk",
  "especially", "focus", "fruit", "honest", "match", "palm",
  "perfectly", "pillow", "pity", "poison", "roar", "shift",
  "slightly", "thump", "truck", "tune", "twenty", "unable",
  "wipe", "wrote", "coat", "constant", "dinner", "drove", "egg",
  "eternal", "flight", "flood", "frame", "freak", "gasp", "glad",
  "hollow", "motion", "peer", "plastic", "root", "screen",
  "season", "sting", "strike", "team", "unlike", "victim",
  "volume", "warn", "weird", "attack", "await", "awake", "built",
  "charm", "crave", "despair", "fought", "grant", "grief",
  "horse", "limit", "message", "ripple", "sanity", "scatter",
  "serve", "split", "string", "trick", "annoy", "blur", "boat",
  "brave", "clearly", "cling", "connect", "fist", "forth",
  "imagination", "iron", "jock", "judge", "lesson", "milk",
  "misery", "nail", "naked", "ourselves", "poet", "possible",
  "princess", "sail", "size", "snake", "society", "stroke",
  "torture", "toss", "trace", "wise", "bloom", "bullet", "cell",
  "check", "cost", "darling", "during", "footstep", "fragile",
  "hallway", "hardly", "horizon", "invisible", "journey",
  "midnight", "mud", "nod", "pause", "relax", "shiver", "sudden",
  "value", "youth", "abuse", "admire", "blink", "breast",
  "bruise", "constantly", "couple", "creep", "curve",
  "difference", "dumb", "emptiness", "gotta", "honor", "plain",
  "planet", "recall", "rub", "ship", "slam", "soar", "somebody",
  "tightly", "weather", "adore", "approach", "bond", "bread",
  "burst", "candle", "coffee", "cousin", "crime", "desert",
  "flutter", "frozen", "grand", "heel", "hello", "language",
  "level", "movement", "pleasure", "powerful", "random",
  "rhythm", "settle", "silly", "slap", "sort", "spoken", "steel",
  "threaten", "tumble", "upset", "aside", "awkward", "bee",
  "blank", "board", "button", "card", "carefully", "complain",
  "crap", "deeply", "discover", "drag", "dread", "effort",
  "entire", "fairy", "giant", "gotten", "greet", "illusion",
  "jeans", "leap", "liquid", "march", "mend", "nervous", "nine",
  "replace", "rope", "spine", "stole", "terror", "accident",
  "apple", "balance", "boom", "childhood", "collect", "demand",
  "depression", "eventually", "faint", "glare", "goal", "group",
  "honey", "kitchen", "laid", "limb", "machine", "mere", "mold",
  "murder", "nerve", "painful", "poetry", "prince", "rabbit",
  "shelter", "shore", "shower", "soothe", "stair", "steady",
  "sunlight", "tangle", "tease", "treasure", "uncle", "begun",
  "bliss", "canvas", "cheer", "claw", "clutch", "commit",
  "crimson", "crystal", "delight", "doll", "existence",
  "express", "fog", "football", "gay", "goose", "guard",
  "hatred", "illuminate", "mass", "math", "mourn", "rich",
  "rough", "skip", "stir", "student", "style", "support",
  "thorn", "tough", "yard", "yearn", "yesterday", "advice",
  "appreciate", "autumn", "bank", "beam", "bowl", "capture",
  "carve", "collapse", "confusion", "creation", "dove",
  "feather", "girlfriend", "glory", "government", "harsh", "hop",
  "inner", "loser", "moonlight", "neighbor", "neither", "peach",
  "pig", "praise", "screw", "shield", "shimmer", "sneak", "stab",
  "subject", "throughout", "thrown", "tower", "twirl", "wow",
  "army", "arrive", "bathroom", "bump", "cease", "cookie",
  "couch", "courage", "dim", "guilt", "howl", "hum", "husband",
  "insult", "led", "lunch", "mock", "mostly", "natural",
  "nearly", "needle", "nerd", "peaceful", "perfection", "pile",
  "price", "remove", "roam", "sanctuary", "serious", "shiny",
  "shook", "sob", "stolen", "tap", "vain", "void", "warrior",
  "wrinkle", "affection", "apologize", "blossom", "bounce",
  "bridge", "cheap", "crumble", "decision", "descend",
  "desperately", "dig", "dot", "flip", "frighten", "heartbeat",
  "huge", "lazy", "lick", "odd", "opinion", "process", "puzzle",
  "quietly", "retreat", "score", "sentence", "separate",
  "situation", "skill", "soak", "square", "stray", "taint",
  "task", "tide", "underneath", "veil", "whistle", "anywhere",
  "bedroom", "bid", "bloody", "burden", "careful", "compare",
  "concern", "curtain", "decay", "defeat", "describe", "double",
  "dreamer", "driver", "dwell", "evening", "flare", "flicker",
  "grandma", "guitar", "harm", "horrible", "hungry", "indeed",
  "lace", "melody", "monkey", "nation", "object", "obviously",
  "rainbow", "salt", "scratch", "shown", "shy", "stage", "stun",
  "third", "tickle", "useless", "weakness", "worship",
  "worthless", "afternoon", "beard", "boyfriend", "bubble",
  "busy", "certain", "chin", "concrete", "desk", "diamond",
  "doom", "drawn", "due", "felicity", "freeze", "frost",
  "garden", "glide", "harmony", "hopefully", "hunt", "jealous",
  "lightning", "mama", "mercy", "peel", "physical", "position",
  "pulse", "punch", "quit", "rant", "respond", "salty", "sane",
  "satisfy", "savior", "sheep", "slept", "social", "sport",
  "tuck", "utter", "valley", "wolf", "aim", "alas", "alter",
  "arrow", "awaken", "beaten", "belief", "brand", "ceiling",
  "cheese", "clue", "confidence", "connection", "daily",
  "disguise", "eager", "erase", "essence", "everytime",
  "expression", "fan", "flag", "flirt", "foul", "fur", "giggle",
  "glorious", "ignorance", "law", "lifeless", "measure",
  "mighty", "muse", "north", "opposite", "paradise", "patience",
  "patient", "pencil", "petal", "plate", "ponder", "possibly",
  "practice", "slice", "spell", "stock", "strife", "strip",
  "suffocate", "suit", "tender", "tool", "trade", "velvet",
  "verse", "waist", "witch", "aunt", "bench", "bold", "cap",
  "certainly", "click", "companion", "creator", "dart",
  "delicate", "determine", "dish", "dragon", "drama", "drum",
  "dude", "everybody", "feast", "forehead", "former", "fright",
  "fully", "gas", "hook", "hurl", "invite", "juice", "manage",
  "moral", "possess", "raw", "rebel", "royal", "scale", "scary",
  "several", "slight", "stubborn", "swell", "talent", "tea",
  "terrible", "thread", "torment", "trickle", "usually", "vast",
  "violence", "weave", "acid", "agony", "ashamed", "awe",
  "belly", "blend", "blush", "character", "cheat", "common",
  "company", "coward", "creak", "danger", "deadly", "defense",
  "define", "depend", "desperate", "destination", "dew", "duck",
  "dusty", "embarrass", "engine", "example", "explore", "foe",
  "freely", "frustrate", "generation", "glove", "guilty",
  "health", "hurry", "idiot", "impossible", "inhale", "jaw",
  "kingdom", "mention", "mist", "moan", "mumble", "mutter",
  "observe", "ode", "pathetic", "pattern", "pie", "prefer",
  "puff", "rape", "rare", "revenge", "rude", "scrape", "spiral",
  "squeeze", "strain", "sunset", "suspend", "sympathy", "thigh",
  "throne", "total", "unseen", "weapon", "weary"
};
static unsigned const DictSize = sizeof Words / sizeof Words[0];

using PublicKey = std::array<unsigned char, 32>;
static PublicKey PublicKeys[] = {
  {{0x59, 0xdd, 0x8b, 0x04, 0x72, 0xc2, 0xf6, 0x34, 0xf7, 0xbf, 0xbf, 0x60, 0x82, 0xe8, 0x2a, 0x0a, 0xad, 0x59, 0x84, 0x03, 0x40, 0xbe, 0xea, 0x37, 0xa0, 0xd4, 0x0a, 0x00, 0xa3, 0x50, 0x22, 0x41}},
  {{0x87, 0x3b, 0x1b, 0x26, 0x6e, 0xd4, 0xbb, 0x08, 0xf3, 0x7d, 0xc2, 0x74, 0x1e, 0xd4, 0xa8, 0xc0, 0x21, 0xf4, 0x5d, 0xe1, 0xbd, 0xe5, 0x73, 0x97, 0xdc, 0xc3, 0xf9, 0x17, 0x1c, 0xb6, 0x8f, 0x69}},
  {{0x1c, 0xdf, 0xe1, 0xe4, 0x4b, 0xaf, 0xfc, 0x84, 0x16, 0xdc, 0x88, 0xff, 0x9e, 0x18, 0x2b, 0xe5, 0x31, 0x6a, 0xef, 0x49, 0xb0, 0xd8, 0x88, 0xf0, 0x30, 0x59, 0xd4, 0x15, 0x21, 0xc1, 0xdd, 0x68}},
  {{0x79, 0x84, 0x65, 0x19, 0x09, 0x8b, 0x7e, 0xed, 0x25, 0x16, 0xde, 0x59, 0x12, 0x51, 0xbc, 0xc5, 0xa2, 0xb4, 0xa7, 0x8b, 0xe6, 0x1e, 0x58, 0xec, 0x3b, 0x01, 0x13, 0x09, 0xe6, 0x45, 0x9e, 0x48}},
  {{0x60, 0x0c, 0x31, 0x33, 0xf9, 0xd4, 0x07, 0x86, 0xa7, 0xdf, 0x83, 0xbe, 0x27, 0x9d, 0xb7, 0xf2, 0xa9, 0x47, 0x8f, 0x94, 0xed, 0xc4, 0xa4, 0xb1, 0xd6, 0xb8, 0xf7, 0x84, 0x38, 0xa4, 0x5b, 0x30}},
  {{0x0f, 0x87, 0x59, 0xd2, 0x1c, 0xff, 0xaa, 0x46, 0x31, 0xbd, 0x41, 0x73, 0x8d, 0x6d, 0xa4, 0x47, 0x00, 0xe3, 0x5f, 0x46, 0x9b, 0x7f, 0xd3, 0x8d, 0x99, 0xf3, 0xd3, 0xe2, 0x30, 0xe0, 0xe7, 0x00}},
  {{0x15, 0x5a, 0x83, 0xcb, 0x7f, 0xd3, 0x58, 0x4f, 0xb9, 0xd0, 0x9c, 0x7e, 0x6a, 0x46, 0x8b, 0xa7, 0x8c, 0x94, 0xb2, 0xff, 0xff, 0xaf, 0x6f, 0x79, 0x3a, 0x9c, 0x76, 0x9c, 0x71, 0x4d, 0x27, 0x2a}},
  {{0xc9, 0x3e, 0x74, 0x99, 0x61, 0x38, 0x9e, 0xf2, 0x5c, 0x7b, 0x20, 0x42, 0x12, 0x76, 0x2e, 0xad, 0x06, 0x9e, 0x50, 0xc5, 0xbe, 0x8e, 0x94, 0x0c, 0x88, 0xf2, 0xa5, 0xb0, 0x40, 0xb1, 0x8b, 0x78}},
  {{0x05, 0x22, 0x5b, 0xb6, 0x42, 0x86, 0xff, 0xc7, 0x07, 0x01, 0xf1, 0xbb, 0xf8, 0xfc, 0x5c, 0xe8, 0xd2, 0x82, 0xab, 0x50, 0xc8, 0xd7, 0xb5, 0xe9, 0x61, 0x16, 0xf0, 0x92, 0x76, 0x11, 0x63, 0x25}},
  {{0x8f, 0xfe, 0x32, 0x98, 0xe1, 0x86, 0xce, 0x7d, 0x32, 0x92, 0x08, 0xca, 0x52, 0x20, 0x81, 0x78, 0x5f, 0xca, 0xc5, 0x9f, 0xf1, 0x85, 0x2c, 0xf6, 0xae, 0xe3, 0x24, 0x32, 0x84, 0x58, 0x15, 0x47}},
  {{0x33, 0xb7, 0xf0, 0xb0, 0x3e, 0xa5, 0xc0, 0xd0, 0x8a, 0x5f, 0x9b, 0x50, 0x15, 0x8b, 0x15, 0xb0, 0xcd, 0xdd, 0x09, 0x03, 0x41, 0xcc, 0xdf, 0x75, 0xea, 0x28, 0x49, 0xf3, 0x35, 0xc6, 0xcf, 0x55}},
  {{0x72, 0xd6, 0x93, 0xd0, 0xe3, 0xeb, 0x17, 0xab, 0x48, 0x4c, 0xbb, 0x68, 0xe4, 0x0e, 0xdb, 0x9c, 0xb1, 0x9c, 0x0e, 0x3e, 0x04, 0xa6, 0x84, 0xb6, 0x32, 0x5a, 0x47, 0x99, 0x08, 0x45, 0x19, 0x48}}
};

static char const *Wallets[] = {
  "BURST-GMVF-Z5L4-LGWZ-8BW6W   (entropy of 10.66 bits)",
  "BURST-ADFP-EN99-24FD-44QA7   (entropy of 21.334 bits)",
  "BURST-UP6D-R28A-67XL-DYBJL	(entropy of 32 bits)",
  "BURST-24M6-5CWP-CPPZ-D9PVS	(entropy of 42.67 bits)",
  "BURST-RT5Y-YLDA-AZ5R-6T6MN	(entropy of 53.34 bits)",
  "BURST-AYQF-7YUJ-A88H-D32VQ	(entropy of 64 bits)",
  "BURST-ND84-WUE8-L9EZ-C27NB	(entropy of 74.67 bits)",
  "BURST-K8GV-VEAA-LRLS-F5C58	(entropy of 85.33 bits)",
  "BURST-YRZY-WDWF-XQ35-AURDX	(entropy of 96 bits)",
  "BURST-RGGF-SJ88-272C-G3RXG	(entropy of 106.67 bits)",
  "BURST-P7SA-89F9-62F4-53MEG	(entropy of 117.34 bits)",
  "BURST-6L9L-LULB-XVAZ-463RB	(entropy of 128 bits)"
};
static unsigned const nWallets = sizeof Wallets / sizeof Wallets[0];

void Usage(char const *progname);
